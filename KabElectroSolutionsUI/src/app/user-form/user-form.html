<div class="w-full min-h-screen bg-gray-100 p-8 flex justify-center items-start overflow-y-auto divheight">
  <mat-card class="w-full max-w-6xl shadow-xl rounded-2xl">
    <mat-card-header class="bg-blue-600 text-white p-4 flex justify-between items-center rounded-t-2xl">
      <mat-card-title class="text-lg font-semibold text-black">{{ title }}</mat-card-title>
      <button mat-icon-button (click)="onClose()" class="text-white hover:text-red-300 text-xl font-bold">âœ•</button>
    </mat-card-header>

    <hr class="my-0 marginbottom border-gray-300" />

    <mat-card-content class="p-6">
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="row gy-3 mrgtop">
         <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" />
            <mat-error *ngIf="userForm.get('firstName')?.hasError('required')">
             first Name  is required
            </mat-error>
          </mat-form-field>
        </div>
          <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" />
            <mat-error *ngIf="userForm.get('lastName')?.hasError('required')">
             Last Name  is required
            </mat-error>
          </mat-form-field>
        </div>
        <!-- Customer Mobile No -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User Mobile No</mat-label>
            <input matInput formControlName="phone" />
            <mat-error *ngIf="userForm.get('phone')?.hasError('required')">User Mobile No is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Customer Email -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User Email</mat-label>
            <input matInput formControlName="email" />
            <mat-error *ngIf="userForm.get('email')?.hasError('required')">User is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Customer State -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User State</mat-label>
            <input matInput formControlName="stateId"
                   [matAutocomplete]="stateAuto"
                   (focus)="showState()"
                   (input)="showState()" />
            <mat-autocomplete #stateAuto="matAutocomplete" [displayWith]="displayState" autoActiveFirstOption (optionSelected)="onStateSelected($event.option.value)">
              <mat-option *ngFor="let state of filteredStates$ | async" [value]="state">{{ state.name }}</mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('stateId')?.hasError('required')">User State is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Customer City -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User City</mat-label>
            <input matInput formControlName="cityId"
                   [matAutocomplete]="cityAuto"
                   (focus)="showCities()"
                   (input)="showCities()" />
            <mat-autocomplete #cityAuto="matAutocomplete" [displayWith]="displayCities" autoActiveFirstOption (optionSelected)="onCitySelected($event.option.value)">
              <mat-option *ngFor="let city of filteredCities$ | async" [value]="city">{{ city.name }}</mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('cityId')?.hasError('required')">User City is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Customer Address -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User Address</mat-label>
            <textarea matInput formControlName="address" rows="2"></textarea>
            <mat-error *ngIf="userForm.get('address')?.hasError('required')">User Address is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Customer Pincode -->
        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>User Pincode</mat-label>
            <input matInput formControlName="pinCodeId"
                   [matAutocomplete]="pincodeAuto"
                   (focus)="showPincode()"
                   (input)="showPincode()" />
            <mat-autocomplete #pincodeAuto="matAutocomplete" [displayWith]="displayPincodes">
              <mat-option *ngFor="let pin of filteredPincodes$ | async" [value]="pin">{{ pin.pincode }}</mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="userForm.get('pinCodeId')?.hasError('required')">User Pincode is required</mat-error>
          </mat-form-field>
        </div>

        <div class="col-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Select Role</mat-label>
            <mat-select formControlName="roleId">
              <mat-option *ngFor="let role of roles" [value]="role.roleId">
                {{ role.roleName }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('roleId')?.hasError('required')">
              User Role is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="col-12 text-end mt-4">
          <button mat-raised-button color="primary" type="submit">{{ submitBtnLabel }}</button>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>
